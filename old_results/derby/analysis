a lot many code, there is a basic sm setup and then has some test cases on changing sm's policy
